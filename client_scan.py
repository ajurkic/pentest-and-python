#!/usr/bin/env python

from scapy.all import *
import sys, os

# Console colors
W  = '\033[0m'  # white (normal)
R  = '\033[31m' # red
G  = '\033[32m' # green
O  = '\033[33m' # orange
B  = '\033[34m' # blue
P  = '\033[35m' # purple
C  = '\033[36m' # cyan
GR = '\033[37m' # gray
T  = '\033[93m' # tan

os.system("clear")
clientList = []
AP_MAC = sys.argv[1].lower()

def ClientScan(pkt):
    if pkt.haslayer(Dot11):
        if pkt.addr1 and pkt.addr2 and pkt.addr1!="ff:ff:ff:ff:ff:ff":
            if AP_MAC == pkt.addr1:
                #If it is Assocciation Req or Resp OR Reassocciation Req or Resp
                if pkt.type in [0, 1, 2, 3]:
                    if (pkt.addr2 not in clientList) and pkt.addr2 != "":
                        clientList.append(pkt.addr2)
                        print O+ "AP: " +W+ pkt.addr1 +O+ "   Client: " +W+ pkt.addr2

if __name__ == "__main__":
    print B+ "Listing clients connected to %s" % (sys.argv[1])
    sniff(iface="wlan0mon", prn=ClientScan)