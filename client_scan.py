#!/usr/bin/env python

from scapy.all import *

observedclients = []

def sniffmgmt(pkt):
    # Tuple(immutable list) made from 3 management subtypes 
    # that is sent exclusively by clients
    stamgmtstypes = (0, 2, 4)

    if pkt.haslayer(Dot11):
        if pkt.type == 0 and pkt.subtype in stamgmtstypes:
            if pkt.addr2 not in observedclients:
                if pkt.subtype == 4:
                    temp = pkt.getlayer(Dot11Elt)
                    while temp.ID != 0:
                        temp = temp.payload
                    print "AP: " + temp.info + " Client: " + pkt.addr2 + " ProbeReq"
                
                else:
                    print "AP: " + pkt.info + " Client: " + pkt.addr2
                observedclients.append(pkt.addr2)
if __name__ == "__main__":
    sniff(iface="wlan0mon", prn=sniffmgmt)