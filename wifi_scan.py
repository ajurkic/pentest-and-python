#!/usr/bin/python

#Suppress Scapy IPv6 warning
import logging
logging.getLogger("scapy.runtime").setLevel(logging.ERROR)

import os
import sys
from scapy.all import *
#from scapy.layers.dot11 import Dot11
#from scapy.sendrecv import sniff

"""
def check_root():
    if not os.geteuid() == 0:
        print __file__ + " requires root permissions."
        exit(1)
"""
os.system("clear")
ap_list = []

def packet_handler(pkt):
    if pkt.haslayer(Dot11):
        if pkt.type == 0 and pkt.subtype == 8:
            if pkt.addr2 not in ap_list:
                ap_list.append(pkt.addr2)
                print "AP MAC: %s with SSID: %s " % (pkt.addr2, pkt.info)
                #print pkt.show()

if __name__ == "__main__":
    sniff(iface="wlan0mon", prn=packet_handler)